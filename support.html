<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Anonymous Support - BOMA Students</title>
    <!-- ... other meta tags ... -->

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />

    <!-- Original Template CSS -->
    <link rel="stylesheet" href="css/animate.css" />
    <link rel="stylesheet" href="css/owl.carousel.min.css" />
    <link rel="stylesheet" href="css/owl.theme.default.min.css" />
    <link rel="stylesheet" href="css/magnific-popup.css" />
    <link rel="stylesheet" href="css/bootstrap-datepicker.css" />
    <link rel="stylesheet" href="css/jquery.timepicker.css" />
    <link rel="stylesheet" href="css/flaticon.css" />
    <link rel="stylesheet" href="css/style.css" />

    <!-- Custom CSS Files -->
    <link rel="stylesheet" href="css/custom.css" />
    <!-- Main custom styles -->
    <link rel="stylesheet" href="css/pages.css" />
    <!-- Page-specific styles -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      .modal-backdrop {
        background-color: rgba(0, 0, 0, 0.5);
      }
      .success-icon {
        color: #28a745;
        font-size: 3rem;
      }
      .spinner-border {
        width: 3rem;
        height: 3rem;
      }
    </style>
  </head>
  <body>
    <!-- ... same navbar ... -->

    <section
      class="hero-wrap hero-wrap-2"
      style="background-image: url(&quot;images/support-bg.jpg&quot;)"
    >
      <div class="overlay"></div>
      <div class="container">
        <div
          class="row no-gutters slider-text align-items-end justify-content-center"
        >
          <div class="col-md-9 ftco-animate pb-5 text-center">
            <h1 class="mb-3 bread">Get Support</h1>
            <p class="breadcrumbs">
              Reach out anonymously. We're here to help.
            </p>
          </div>
        </div>
      </div>
    </section>

    <section class="ftco-section">
      <div class="container">
        <!-- Emergency Contact Banner -->
        <div class="row mb-5">
          <div class="col-md-12">
            <div class="emergency-banner p-4 bg-danger text-white text-center">
              <h3>Need Immediate Help?</h3>
              <p class="mb-0">24/7 Crisis Hotline: 1-800-XXX-XXXX</p>
              <p>Campus Emergency: XXX-XXX-XXXX</p>
            </div>
          </div>
        </div>

        <!-- Form Container -->
        <div class="row justify-content-center">
          <div class="col-md-8">
            <div class="card shadow">
              <div class="card-body">
                <h3 class="card-title text-center mb-4">
                  Anonymous Support Request
                </h3>
                <form id="anonymousForm">
                  <div class="mb-3">
                    <label for="name" class="form-label">Name</label>
                    <input
                      type="text"
                      class="form-control"
                      id="name"
                      name="name"
                      required
                    />
                  </div>
                  <div class="mb-3">
                    <label for="email" class="form-label">Email</label>
                    <input
                      type="email"
                      class="form-control"
                      id="email"
                      name="email"
                      required
                    />
                  </div>
                  <div class="mb-3">
                    <label for="feelingScale" class="form-label"
                      >How are you feeling? (1-5)</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="feelingScale"
                      name="feelingScale"
                      min="1"
                      max="5"
                      required
                    />
                  </div>
                  <div class="mb-3">
                    <label for="concern" class="form-label"
                      >What's troubling you?</label
                    >
                    <textarea
                      class="form-control"
                      id="concern"
                      name="concern"
                      rows="4"
                      required
                    ></textarea>
                  </div>
                  <div class="mb-3">
                    <label for="supportType" class="form-label"
                      >Type of Support Needed</label
                    >
                    <select
                      class="form-control"
                      id="supportType"
                      name="supportType"
                      required
                    >
                      <option value="immediate">Immediate Support</option>
                      <option value="scheduled">Scheduled Consultation</option>
                    </select>
                  </div>
                  <button type="submit" class="btn btn-primary w-100">
                    Submit Anonymously
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Modals -->
    <div class="modal fade" id="loadingModal">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body text-center p-4">
            <div class="spinner-border text-primary mb-3"></div>
            <h5>Processing Your Request...</h5>
            <p class="text-muted mb-0">
              Please wait while we submit your information.
            </p>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="successModal">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body text-center p-4">
            <i class="fas fa-check-circle success-icon mb-3"></i>
            <h5>Thank You!</h5>
            <p>Your request has been submitted successfully.</p>
            <p>Your Case ID: <strong id="successCaseId"></strong></p>
            <p class="text-muted">
              A council member will reach out to you soon.
            </p>
            <button
              type="button"
              class="btn btn-primary mt-3"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Get all required elements
        const form = document.getElementById("anonymousForm");
        const loadingModalElement = document.getElementById("loadingModal");
        const successModalElement = document.getElementById("successModal");
        const successCaseIdElement = document.getElementById("successCaseId");

        // Check if all required elements exist
        if (
          !form ||
          !loadingModalElement ||
          !successModalElement ||
          !successCaseIdElement
        ) {
          console.error("Required elements not found:", {
            form: !!form,
            loadingModal: !!loadingModalElement,
            successModal: !!successModalElement,
            successCaseId: !!successCaseIdElement,
          });
          return;
        }

        // Initialize Bootstrap modals
        const loadingModal = new bootstrap.Modal(loadingModalElement);
        const successModal = new bootstrap.Modal(successModalElement);

        // Handle form submission
        form.addEventListener("submit", function (e) {
          e.preventDefault();

          // Show loading modal
          loadingModal.show();

          // Create case data
          const caseData = {
            caseId: "BOMA-" + Date.now().toString(36).slice(-6).toUpperCase(),
            name: form.querySelector('[name="name"]').value,
            email: form.querySelector('[name="email"]').value,
            feelingScale: form.querySelector('[name="feelingScale"]').value,
            concern: form.querySelector('[name="concern"]').value,
            supportType: form.querySelector('[name="supportType"]').value,
            status: "pending",
            date: new Date().toISOString(),
          };

          // Simulate processing delay
          setTimeout(() => {
            try {
              // Save to localStorage
              let cases = [];
              const existingCases = localStorage.getItem("cases");
              if (existingCases) {
                cases = JSON.parse(existingCases);
              }
              cases.push(caseData);
              localStorage.setItem("cases", JSON.stringify(cases));

              // Hide loading modal
              loadingModal.hide();

              // Update success modal with case ID
              successCaseIdElement.textContent = caseData.caseId;

              // Show success modal
              successModal.show();

              // Reset form
              form.reset();
            } catch (error) {
              console.error("Error:", error);
              loadingModal.hide();
              showError("An error occurred. Please try again.");
            }
          }, 2000);
        });

        function showError(message) {
          const errorDiv = document.createElement("div");
          errorDiv.className = "alert alert-danger mt-3";
          errorDiv.textContent = message;
          form.insertAdjacentElement("beforebegin", errorDiv);
          setTimeout(() => errorDiv.remove(), 5000);
        }
      });
    </script>
  </body>
</html>
